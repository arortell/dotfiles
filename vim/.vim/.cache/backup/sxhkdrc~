#!/usr/bin/env bash

#################### wm independent hotkeys

# terminal emulator
super + Return
	termite

# My Menu
super + space
  dmenu_extended_run

# Window Switcher
super + shift + space 
  adams_menu_laptop

# Window Switcher
alt + Tab
  rofi window -show
######################## bspwm hotkeys

# make sxhkd reload its configuration files:
super + Escape
<<<<<<< HEAD
	pkill -x sxhkd; notify-send "Sxhkd Configuration Reloaded"

# refresh or quit bspwm
super + shift + {_,alt + }Escape
	{pkill -x polybar; bspc wm -d > "$BSPWM_STATE" && bspc quit; notify-send "Bspwm Reloaded", \
	 pkill -x polybar; bspc quit 1}
=======
	pkill -USR1 -x sxhkd && notify-send "Sxhkd Configuration Reloaded"

# refresh or quit bspwm
super + shift + {_,alt + }Escape
	{pkill -x panel; bspc wm -d > "$BSPWM_STATE" && bspc quit; notify-send "Bspwm Reloaded", \
	 pkill -x panel; bspc quit 1}
>>>>>>> caf0250a14d4b3bce049223e87a0f106a25af0c4

# Adjust gaps on the fly
super + {minus,equal}
 bspc config --desktop focused window_gap $((`bspc config --desktop focused window_gap` {+,-} 2 ))

# close and kill
super + Delete
	bspc node --kill

# if the current node is automatic, send it to the last manual, otherwise pull the last leaf
super + y
	bspc query --nodes --node focused.automatic && bspc node --node last.!automatic || bspc node last.leaf --node focused

# swap the current node and the biggest node
super + g
	bspc node --swap biggest

############################ state/flags

# alternate between the tiled and monocle layout
super + ctrl + m
	bspc desktop --layout next

# set the window state
super + {t,shift + f,f}
	bspc node --state {tiled,floating,fullscreen}

# set the node flags
super + ctrl + {x,y,z}
	bspc node --flag {locked,sticky,private}


############################## focus/swap


# focus the node in the given direction
super + {_,shift + }{Left,Down,Up,Right}
	bspc node --{focus,swap} {west,south,north,east}

# focus the next/previous node
super + {_,shift + }c
	bspc node --focus {next,prev}

# focus the next/previous desktop
super + bracket{left,right}
	bspc desktop --focus {prev,next}

# focus the last node/desktop
super + grave
	bspc node --focus last

# focus the older or newer node in the focus history
super + {o,i}
	bspc wm --record-history off; \
	bspc node {older,newer} --focus; \
	bspc wm --record-history on

# focus or send to the given desktop
super + {_,shift + }{1-9,0}
	bspc {desktop --focus,node --to-desktop} '^{1-9,10}'

# focus or send window/node to monitor
#super + {_,shift + } {comma,period,slash}
#  bspc {monitor --focus,node --to-monitor} {TV,Center,Right}

# Swap desktops
super + alt + {1-9,0}
  bspc desktop focused --swap '^{1-9,0}'

############################################ preselect

# preselect the direction
super + ctrl + {Left,Down,Up,Right}
	bspc node --presel-dir {west,south,north,east}

# preselect the ratio
super + ctrl + {1-9}
	bspc node --presel-ratio 0.{1-9}

# cancel the preselection for the focused node
super + ctrl + space
	bspc node --presel-dir cancel

# cancel the preselection for the focused desktop
super + ctrl + shift + space
	bspc query --nodes --desktop | xargs -I id --node 1 bspc node id --presel-dir cancel

# resize windows
super + alt + {Left,Down,Up,Right}
   ~/bin/bspwm_resize {west,south,north,east}


###################################################### Media Keys

# Raiser Sound 
XF86AudioRaiseVolume
 amixer set Master 2%+ && notify-send Audio Raised to $(alsavol -d)

# Raise/Lower Sound 
XF86AudioLowerVolume
 amixer set Master 2%- && notify-send Audio Lowered to $(alsavol -d)

# Mute  
XF86AudioMute
  amixer set Master toggle && notify-send $(alsavol -d)

# start || pause || play cmus
XF86AudioPlay
  cplay

# start || pause || play cmus
XF86AudioNext
  cmus-remote -n
	
# start || pause || play cmus
XF86AudioPrev
  cmus-remote -r

# Screenshot
@Print
	scrot -s && notify-send "ScreenShot Taken"


##################################################### Applications
super + shift + Return
  qutebrowser

# Zim wiki notes
super + z
	zim

# atom text editor
super + a
	atom

# screen lock
super + l
  slock

# C/C++ develop
super + q
  qtcreator

# Python dev
super + w
  wing6.1

# tor browser
super + b
  sandboxed-tor-browser

####################################################### Scratchpads
F1
<<<<<<< HEAD
   xdotool search --onlyvisible --class _scratch windowunmap \
      || xdotool search --class _scratch windowmap \
      || termite --class=_scratch --geometry=1459x756 --exec byobu

F12
   xdotool search --onlyvisible --class _htop windowunmap \
      || xdotool search --class _htop windowmap \
      || termite --class=_htop --geometry=1459x756 --exec vifm 

#super + F5
#    id=$(bspc query -N -n "focused");\
#    if [ -n "$id" ];then \
#        xprop -id $id -f _SCRATCH 32ii -set _SCRATCH $(date +%s,%N);\
#        bspc node -t "floating";\
#        xdotool windowunmap $id;\
#    fi

#F5
#    i=$(bspc query -N -n "focused.floating");\
#    if [ -n "$i" ];then \
#        xprop -id $i -f _SCRATCH 32ii -set _SCRATCH $(date +%s,%N);\
#        xdotool windowunmap $i;\
#    else;\
#        i=$(for w in $(xwininfo -root -children | grep -e "^\s*0x[0-9a-f]\+" -o);do \
#            t=$(xprop -id $w _SCRATCH | grep ' = \(.*\)');\
#            if [ -n "$t" ];then \
#                echo $t $w;\
#            fi;\
#        done|sort -n|head -n1|cut -d" " -f 5);\
#        if [ -n "$i" ];then \
#            xprop -id $i -remove _SCRATCH;\
#            bspc rule -a \* state=floating center=on --one-shot;\
#            xdotool windowmap $i;\
#            bspc node -f $i;\
#        fi;\
#    fi
=======
   xdotool search --onlyvisible --classname _scratch windowunmap \
      || xdotool search --classname _scratch windowmap \
<<<<<<< HEAD
      || terminology --name=_scratch --title=_scratch --geometry=168x48  --exec byobu
=======
<<<<<<< HEAD
      || terminology --name=_scratch --title=_scratch --geometry=172x56  --exec byobu
=======
      || terminology --name=_scratch --title=_scratch --geometry=198x60  --exec byobu
>>>>>>> 6c993a39beb17f5917e1e41325cf051eca50cf87
>>>>>>> a9886c25e47238ddc939eac3497629383751270e

F12
   xdotool search --onlyvisible --classname _vifm windowunmap \
      || xdotool search --classname _vifm windowmap \
<<<<<<< HEAD
      || terminology --name=_vifm --title=_vifm --geometry=168x48 --exec vifm 
=======
<<<<<<< HEAD
      || terminology --name=_vifm --title=_vifm --geometry=172x56 --exec vifm 
=======
      || terminology --name=_vifm --title=_vifm --geometry=198x60 --exec vifm 
>>>>>>> 6c993a39beb17f5917e1e41325cf051eca50cf87
>>>>>>> a9886c25e47238ddc939eac3497629383751270e

super + F5
    id=$(bspc query -N -n "focused");\
    if [ -n "$id" ];then \
        xprop -id $id -f _SCRATCH 32ii -set _SCRATCH $(date +%s,%N);\
        bspc node -t "floating";\
        xdotool windowunmap $id;\
    fi

F5
    i=$(bspc query -N -n "focused.floating");\
    if [ -n "$i" ];then \
        xprop -id $i -f _SCRATCH 32ii -set _SCRATCH $(date +%s,%N);\
        xdotool windowunmap $i;\
    else;\
        i=$(for w in $(xwininfo -root -children | grep -e "^\s*0x[0-9a-f]\+" -o);do \
            t=$(xprop -id $w _SCRATCH | grep ' = \(.*\)');\
            if [ -n "$t" ];then \
                echo $t $w;\
            fi;\
        done|sort -n|head -n1|cut -d" " -f 5);\
        if [ -n "$i" ];then \
            xprop -id $i -remove _SCRATCH;\
            bspc rule -a \* state=floating center=on --one-shot;\
            xdotool windowmap $i;\
            bspc node -f $i;\
        fi;\
    fi
>>>>>>> caf0250a14d4b3bce049223e87a0f106a25af0c4

